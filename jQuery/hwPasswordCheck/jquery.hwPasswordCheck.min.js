/*
 * hwPasswordCheck v.1.0.0
 * (c) 2014 Highwire Design Ltd
 * Released under Creative Commons Attribution-NonCommercial-Sharealike (CC-BY-NC-SA) - www.creativecommons.org.uk
 * For commercial use please contact Highwire Design Ltd - design@highwiredesign.com
 * More information: design@highwiredesign.com
 * This header must remain with code
 */
(function($){$.fn.hwPasswordCheck=function(o){var o=$.extend({backgrounds:["#a90b0b","#50a050","#057705"],textcolour:["#fff","#fff","#fff"],minChar:8,minCharWeight:10,upperLowerWeight:10,oneDigitWeight:10,longWeight:2,extraLongWeight:2,extraDigitsWeight:2,specialCharWeight:2,extraSpecialWeight:2,minScore:30,topScore:34},o);return this.each(function(){$(this).keyup(function(){$.fn.runPassword($(this),o);});});}
$.fn.runPassword=function(p,o){var subButt=p.closest('form').find(':submit');var pval=p.val();fScore=$.fn.checkPassword(pval,o);if(pval.length==0){p.css("background-color","");subButt.removeAttr('disabled');subButt.removeAttr('color');}
else if(fScore<o.minScore){p.css("background-color",o.backgrounds[0]);p.css("color",o.textcolour[0]);subButt.attr('disabled','disabled');}
else if(fScore<o.topScore){p.css("background-color",o.backgrounds[1]);p.css("color",o.textcolour[1]);subButt.removeAttr('disabled');}
else{p.css("background-color",o.backgrounds[2]);p.css("color",o.textcolour[2]);subButt.removeAttr('disabled');}}
$.fn.checkPassword=function(p,o){var pwScore=0;if(p.length>=o.minChar){pwScore=pwScore+o.minCharWeight;}
if(p.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){pwScore=pwScore+o.upperLowerWeight;}
if(p.match(/\d+/)){pwScore=pwScore+o.oneDigitWeight;}
if(p.length>(Math.round(o.minChar*1.5))){pwScore=pwScore+o.longWeight;}
if(p.length>(o.minChar*2)){pwScore=pwScore+o.extraLongWeight;}
if($.fn.countMatches(p,/\d/g)>2){pwScore=pwScore+o.extraDigitsWeight;}
if(p.match(/.[!,@,#,$,%,^,&,*,?,_,~]/)){pwScore=pwScore+o.specialCharWeight;}
if($.fn.countMatches(p,/[!,@,#,$,%,^,&,*,?,_,~]/g)>2){pwScore=pwScore+o.extraSpecialWeight;}
return pwScore;}
$.fn.countMatches=function(p,regex){var result=p.match(regex);return result?result.length:0;}})(jQuery);